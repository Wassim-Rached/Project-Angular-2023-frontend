<div *ngIf="isPageLoading; else page">loading...</div>

<ng-template #page>
  <div class="container">
    <div *ngIf="!activity">activity not found !</div>
  </div>

  <div class="container p-4" *ngIf="activity">
    <div class="row justify-content-between">
      <div class="col-8 shadow-lg p-0">
        <div
          [ngClass]="activity.is_free ? 'bg-success' : 'bg-info'"
          class="bg-secondary p-2 text-center bg- fs-6 text-white text-uppercase"
        >
          {{ activity.is_free ? "Free" : "Paid : " + activity.price + "$" }}
        </div>
        <div>
          <h1
            class="fs-3 text-center p-3 text-danger fs-2 text-uppercase fw-bold"
          >
            {{ activity.title }}
          </h1>
          <img [src]="activity.photo_url" width="100%" alt="" />
        </div>
        <div class="d-flex mt-4 justify-content-between align-items-center">
          <div>
            <div
              class="badge fs-6 bg-info m-1"
              *ngFor="let category of activity.categories"
            >
              {{ category.name }}
            </div>
          </div>
          <div>
            <span class="ms-auto badge bg-danger">
              {{ activity.number_of_likes }} Likes
            </span>
            <button
              (click)="onLike()"
              mat-button
              [disabled]="!isAuthenticated || didLike"
            >
              LIKE
              <mat-icon [ngClass]="{ 'been-liked': didLike }"
                >favorite</mat-icon
              >
            </button>
          </div>
        </div>
        <div class="m-5">
          <p class="fs-6 p-spacing">{{ activity.description }}</p>
        </div>
        <div class="ps-4 pb-4">
          <button
            class="btn btn-success btn-lg"
            (click)="onRegister(activity.id!)"
            [disabled]="didRegister"
          >
            Register now
          </button>
        </div>
      </div>
      <div class="col-3 shadow p-0 m-0">
        <div
          class="bg-success text-white p-3 d-flex align-items-center justify-content-center"
        >
          <span class="fs-5">REGISTRATIONS</span>
        </div>
        <ul class="mt-3 d-flex flex-column gap-3">
          <li
            class="d-flex align-items-center gap-2 text-success"
            *ngFor="let account of activity.registred_accounts"
          >
            <span
              [routerLink]="['profile', account.id]"
              class="profile-img-container"
            >
              <img [src]="account.photo_url" [alt]="account.user?.username" />
            </span>
            <span>
              {{ account.user?.username }}
            </span>
          </li>
        </ul>
      </div>
    </div>
  </div>
</ng-template>
